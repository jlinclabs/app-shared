{"mappings":";;;;;;;;AAAA;;;;;;;ACAA;AAEA,MAAM,0BAAI,GAAG,IAAM,EAAE;AAEN,oDAAyB;IACtC,IAAI,QAAQ,GAAG,CAAA,GAAA,eAAQ,CAAA,EAAE,CAAC,CAAC,CAAC;IAC5B,CAAA,GAAA,gBAAS,CAAA,CAAC,IAAM,IAAM;YAAE,QAAQ,GAAG,0BAAI;SAAE,EAAE,EAAE,CAAC;IAC9C,OAAO,CAAA,GAAA,kBAAW,CAAA,CAAC,IAAM;QAAE,QAAQ,CAAC,EAAE,CAAC;KAAE,EAAE,EAAE,CAAC,CAAA;CAC/C;;;ADJD,MAAM,4BAAM,GAAG;IAAC,MAAM;IAAE,SAAS;IAAE,UAAU;IAAE,UAAU;CAAC;AAC3C,kDAAkB,aAAa,EAAE,MAAM,GAAG,EAAE,EAAC;IAC1D,MAAM,eAAE,WAAW,CAAA,aAAE,SAAS,CAAA,aAAE,SAAS,CAAA,cAAE,UAAU,CAAA,EAAE,GAAG,MAAM;IAChE,MAAM,SAAS,GAAG,CAAA,GAAA,aAAM,CAAA,EAAE;IAC1B,MAAM,CAAC,MAAM,CAAC,SAAS,EAAE;mBAAE,SAAS;mBAAE,SAAS;oBAAE,UAAU;KAAE,CAAC;IAC9D,MAAM,WAAW,GAAG,CAAA,GAAA,wCAAc,CAAA,EAAE;IACpC,MAAM,GAAG,GAAG,CAAA,GAAA,cAAO,CAAA,CAAC,IAAO,CAAA,EAAE,CAAA,AAAC,EAAE;QAAC,aAAa;QAAE,WAAW;KAAC,CAAC;IAE7D,GAAG,CAAC,IAAI,GAAG,CAAA,GAAA,kBAAW,CAAA,CACpB,CAAI,GAAA,IAAI,GAAK;QACX,IAAI,GAAG,CAAC,OAAO,EAAE,MAAM,IAAI,KAAK,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAA;QACrD,MAAM,QAAQ,GAAG,CAAA,KAAK,GAAI;YACxB,GAAG,CAAC,KAAK,GAAG,4BAAM,CAAC,KAAK,CAAC;YACzB,4BAAM,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,KAAK,GAAK;gBAC9B,GAAG,CAAC,IAAI,CAAC,GAAG,KAAK,KAAK,KAAK;aAC5B,CAAC;YACF,WAAW,EAAE;SACd;QACD,GAAG,CAAC,OAAO,GAAG,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,GAAK;YAC7C,aAAa,IAAI,IAAI,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC;SAC7C,CAAC,CAAC,IAAI,CACL,OAAM,MAAM,GAAI;YACd,OAAO,GAAG,CAAC,OAAO;YAClB,GAAG,CAAC,MAAM,GAAG,MAAM;YACnB,QAAQ,CAAC,CAAC,CAAC;YACX,IAAI,SAAS,CAAC,SAAS,EAAE,MAAM,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC;YAC1D,OAAO,MAAM,CAAA;SACd,EACD,OAAM,KAAK,GAAI;YACb,OAAO,GAAG,CAAC,OAAO;YAClB,GAAG,CAAC,KAAK,GAAG,KAAK;YACjB,IAAI,SAAS,CAAC,SAAS,EAAE,MAAM,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC;YACzD,QAAQ,CAAC,CAAC,CAAC;YACX,OAAO,KAAK,CAAA;SACb,CACF,CAAC,IAAI,CAAC,OAAM,MAAM,GAAI;YACrB,IAAI,SAAS,CAAC,UAAU,EAAE,MAAM,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC;SAC7D,CAAC;QACF,QAAQ,CAAC,CAAC,CAAC;QACX,OAAO,GAAG,CAAC,OAAO,CAAA;KACnB,EACD;QAAC,GAAG;KAAC,CACN;IAED,CAAA,GAAA,gBAAS,CAAA,CACP,IAAM;QAAE,IAAI,WAAW,IAAI,GAAG,CAAC,IAAI,EAAE,GAAG,CAAC,IAAI,EAAE;KAAE,EACjD;QAAC,GAAG;KAAC,CACN;IAED,OAAO,GAAG,CAAA;CACX","sources":["client-src/hooks/useAsync.js","client-src/hooks/useForceUpdate.js"],"sourcesContent":["import * as React from 'react'\nimport { useRef, useMemo, useCallback, useEffect } from 'react'\nimport useForceUpdate from './useForceUpdate'\n\nconst STATES = ['idle', 'pending', 'resolved', 'rejected']\nexport default function useAsync(asyncFunction, config = {}){\n  const { callOnMount, onSuccess, onFailure, onComplete } = config\n  const callbacks = useRef()\n  Object.assign(callbacks, { onSuccess, onFailure, onComplete })\n  const forceUpdate = useForceUpdate()\n  const ctx = useMemo(() => ({}), [asyncFunction, callOnMount])\n\n  ctx.call = useCallback(\n    (...args) => {\n      if (ctx.promise) throw new Error(`already executing`)\n      const setState = state => {\n        ctx.state = STATES[state]\n        STATES.forEach((name, index) => {\n          ctx[name] = index === state\n        })\n        forceUpdate()\n      }\n      ctx.promise = new Promise((resolve, reject) => {\n        asyncFunction(...args).then(resolve, reject)\n      }).then(\n        async result => {\n          delete ctx.promise\n          ctx.result = result\n          setState(2)\n          if (callbacks.onSuccess) await callbacks.onSuccess(result)\n          return result\n        },\n        async error => {\n          delete ctx.promise\n          ctx.error = error\n          if (callbacks.onFailure) await callbacks.onFailure(error)\n          setState(3)\n          return error\n        },\n      ).then(async result => {\n        if (callbacks.onComplete) await callbacks.onComplete(result)\n      })\n      setState(1)\n      return ctx.promise\n    },\n    [ctx]\n  )\n\n  useEffect(\n    () => { if (callOnMount && ctx.idle) ctx.call() },\n    [ctx]\n  )\n\n  return ctx\n}\n","import { useState, useCallback, useEffect } from 'react'\n\nconst noop = () => {}\n\nexport default function useForceUpdate(){\n  let setState = useState()[1]\n  useEffect(() => () => { setState = noop }, [])\n  return useCallback(() => { setState({}) }, [])\n}\n"],"names":[],"version":3,"file":"useAsync.js.map","sourceRoot":"../../"}