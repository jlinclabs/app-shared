#!/usr/bin/env bash

set -e
set -x

export NODE_ENV=development
export NODE_TLS_REJECT_UNAUTHORIZED="0"

SERVER_PORT=$(node find-open-port)
API_SERVER="http://localhost:${SERVER_PORT}"

exec dotenv -e .env -- concurrently \
  --kill-others \
  --names "${APP_NAME} SERVER,${APP_NAME} CLIENT" \
  "PORT=${SERVER_PORT} nodemon -w ./shared -w \"${APP_PATH}\" -- dev-start-server \"${APP_PATH}\"" \
  "API_SERVER=${API_SERVER} dev-start-client \"${APP_PATH}\""

